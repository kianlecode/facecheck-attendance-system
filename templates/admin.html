<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Trang qu·∫£n tr·ªã</title>
  <link rel="icon" href="static/img/neu-logo.png" type="image/x-icon">
  <link rel="stylesheet" href="/static/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet"/>
  <script src="/static/js/utils.js" defer></script>
  <script src="/static/js/admin.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
  <div class="admin-wrapper">
    <div class="admin-layout">
      <!-- Sidebar -->
      <div class="admin-sidebar">
        <h2>Qu·∫£n tr·ªã vi√™n</h2>
        <ul>
          <li><a href="#" class="active" data-section="list" onclick="showSection('list')">Qu·∫£n l√Ω ng∆∞·ªùi d√πng</a></li>
          <li><a href="#" data-section="create" onclick="showSection('create')">T·∫°o t√†i kho·∫£n</a></li>
          <li><a href="#" data-section="info" onclick="showSection('info')">Th√¥ng tin t√†i kho·∫£n</a></li>
          <li><a href="#" class="logout-button mt-4" onclick="showModalLogout()">ƒêƒÉng xu·∫•t</a></li>
        </ul>
      </div>

      <!-- Main content -->
      <div class="admin-main">
        <h1>Xin ch√†o, <span id="admin-name">Admin</span></h1>

        <!-- T·∫°o t√†i kho·∫£n -->
        <section id="section-create" style="display: none;">
          <form id="create-teacher-form">
            <label for="user_id">M√£ ng∆∞·ªùi d√πng:</label>
            <input type="text" id="user_id" required />

            <label for="name">H·ªç t√™n:</label>
            <input type="text" id="name" required />

            <label for="phone_number">S·ªë ƒëi·ªán tho·∫°i:</label>
            <input type="text" id="phone_number" required />

            <label for="email">Email:</label>
            <input type="email" id="email" required />

            <label for="password">M·∫≠t kh·∫©u:</label>
            <input type="password" id="password" required />

            <label for="role">Quy·ªÅn t√†i kho·∫£n:</label>
            <select id="role" required style="max-width: 400px;">
              <option value="student">Sinh vi√™n</option>
              <option value="teacher">Gi·∫£ng vi√™n</option>
              <option value="admin">Qu·∫£n tr·ªã</option>
            </select>

            <div style="margin-top: 1rem;">
              <button type="submit" class="btn">T·∫°o t√†i kho·∫£n</button>
            </div>
          </form>
          <p id="admin-message"></p>
        </section>

        <!-- Qu·∫£n l√Ω t√†i kho·∫£n ng∆∞·ªùi d√πng -->
        <section id="section-list">
          <div class="filter-bar">
            <input type="text" id="search-input" placeholder="üîç T√¨m theo t√™n, email..." style="margin-bottom: 0px;"/>
            <select id="account-role-filter" style="margin-bottom: 0px;">
              <option value="">T·∫•t c·∫£ vai tr√≤</option>
              <option value="student">Sinh vi√™n</option>
              <option value="teacher">Gi·∫£ng vi√™n</option>
              <option value="admin">Qu·∫£n tr·ªã</option>
            </select>
            <button id="load-accounts">üîÑ T·∫£i danh s√°ch</button>
            <button id="export-excel">Xu·∫•t Excel</button>
            <button id="grant-all-students">C·∫≠p nh·∫≠t ·∫£nh</button>
          </div>
          <div id="accounts-list">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>H·ªç t√™n</th>
                  <th>SƒêT</th>
                  <th>Email</th>
                  <th>Vai tr√≤</th>
                  <th>Ng√†y t·∫°o</th>
                  <th>Tr·∫°ng th√°i</th>
                  <th>C·∫≠p nh·∫≠t ·∫£nh</th>
                  <th>H√†nh ƒë·ªông</th>
                </tr>
              </thead>
              <tbody id="account-table-body">
                <!-- JS s·∫Ω render d·ªØ li·ªáu -->
              </tbody>
            </table>
            <div id="pagination" class="pagination-bar"></div>
          </div>
        </section>

        <!-- Th√¥ng tin t√†i kho·∫£n -->
        <section id="section-info" style="display: none;">
          <div id="account-info"></div>
        </section>
      </div>
    </div>
  </div>

  <!-- ‚úÖ Modal x√°c nh·∫≠n ƒëƒÉng xu·∫•t -->
  <div id="modal-logout" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 400px; position: relative;">
      <span class="close" onclick="closeModalLogout()" style="position: absolute; top: 10px; right: 10px; font-size: 24px; cursor: pointer;">&times;</span>
      <h3>ƒêƒÉng xu·∫•t</h3>
      <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?</p>
      <div class="modal-footer" style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 1rem;">
        <button class="btn btn-secondary" onclick="closeModalLogout()">Hu·ª∑</button>
        <button id="modal-logout-confirm" class="btn btn-red">ƒêƒÉng xu·∫•t</button>
      </div>
    </div>
  </div>

  <!-- Script chuy·ªÉn section -->
  <script>
    function showSection(section) {
      ['create', 'list', 'info'].forEach(id => {
        const el = document.getElementById(`section-${id}`);
        if (el) el.style.display = 'none';
      });

      const target = document.getElementById(`section-${section}`);
      if (target) target.style.display = 'block';

      document.querySelectorAll('.admin-sidebar a').forEach(a => a.classList.remove('active'));
      const targetLink = document.querySelector(`.admin-sidebar a[data-section="${section}"]`);
      if (targetLink) targetLink.classList.add('active');

      if (section === 'info') loadAdminInfo();
    }
  </script>
</body>
</html>